<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script type="text/javascript" src="javascripts/swfobject.js"></script>
    <script type="text/javascript">
        // For version detection, set to min. required Flash Player version, or 0 (or 0.0.0), for no version detection. 
        var swfVersionStr = "15.0.0";
        // To use express install, set to playerProductInstall.swf, otherwise the empty string. 
        var xiSwfUrlStr = "playerProductInstall.swf";
        var flashvars = {};
        var params = {};
        params.quality = "high";
        params.bgcolor = "#4a4137";
        params.allowscriptaccess = "sameDomain";
        params.allowfullscreen = "true";
        params.wmode = "direct";
        var attributes = {};
        attributes.id = "HelloWorld";
        attributes.name = "HelloWorld";
        attributes.align = "middle";
        swfobject.embedSWF(
            "examples/HelloWorld/bin/HelloWorld.swf", "flashContent", 
            "320", "480", 
            swfVersionStr, xiSwfUrlStr, 
            flashvars, params, attributes);
        // JavaScript enabled so display the flashContent div in case it is not replaced with a swf object.
        swfobject.createCSS("#flashContent", "display:block;text-align:left;");
    </script>

    <title>Pull-To-Refresh by rozd</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Pull-To-Refresh</h1>
        <h2>&quot;Pull to Refresh&quot; and &quot;Infinity Scroll&quot; implementation for Feathers</h2>
        <a href="https://github.com/rozd/pull-to-refresh" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a name="pull-to-refresh" class="anchor" href="#pull-to-refresh"><span class="octicon octicon-link"></span></a>pull-to-refresh</h1>

<p>"Pull to Refresh" and "Infinity Scroll" implementation for Feathers</p>

<h2>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>Pull to Refresh for latest items</li>
<li>Infinity Scroll for earlier items</li>
<li>Visual indicators for <em>loading</em>, <em>error</em> and <em>empty</em> states</li>
<li>Responsibility of loading items could be delegated to Data Provider</li>
<li>Have no restriction for Header's and Footer's animation</li>
</ul>
<h2><a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Example</h2>
<div id="flashContent">
    <p>
        To view this page ensure that Adobe Flash Player version 
        15.0.0 or greater is installed. 
    </p>
    <script type="text/javascript"> 
        var pageHost = ((document.location.protocol == "https:") ? "https://" : "http://"); 
        document.write("<a href='http://www.adobe.com/go/getflashplayer'><img src='" 
                        + pageHost + "www.adobe.com/images/shared/download_buttons/get_flash_player.gif' alt='Get Adobe Flash player' /></a>" ); 
    </script> 
</div>

<h2><a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>PullToRefresh extends standard Feathers' List, it can be created as usual list:</p>

<div class="highlight highlight-as3"><pre><span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">PullToRefresh</span><span class="o">();</span>
<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">loadImmediately</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> <span class="c1">// indicates that loading of initial items will be started on list created</span>
<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">dataProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">ListCollection</span><span class="o">();</span>
<span class="k">this</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">);</span>
</pre></div>

<p>Then define three methods for loading <strong>initial</strong>, <strong>earlier</strong> and <strong>latest</strong> items:</p>

<div class="highlight highlight-as3"><pre>
<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">loadFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">resultHandler</span><span class="o">:</span><span class="n">Function</span><span class="o">,</span> <span class="n">errorHandler</span><span class="o">:</span><span class="n">Function</span><span class="o">):</span><span class="kc">void</span>
<span class="o">{</span>
  <span class="kd">var</span> <span class="n">result</span><span class="p">:</span><span class="kt">Function</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">value</span><span class="o">:</span><span class="n">Object</span><span class="o">):*</span>
  <span class="o">{</span>
    <span class="n">resultHandler</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">data</span><span class="o">,</span> <span class="n">value</span><span class="o">.</span><span class="na">hasMoreRecords</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="n">Promise</span><span class="o">.</span><span class="na">delay</span><span class="o">({</span><span class="n">data</span> <span class="o">:</span> <span class="o">[{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"M"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"N"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"O"</span><span class="o">}],</span> <span class="n">hasMoreRecords</span> <span class="o">:</span> <span class="kc">true</span><span class="o">},</span> <span class="mi">1000</span><span class="o">).</span><span class="n">then</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="n">otherwise</span><span class="o">(</span><span class="n">errorHandler</span><span class="o">);</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">proceedFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">resultHandler</span><span class="o">:</span><span class="n">Function</span><span class="o">,</span> <span class="n">errorHandler</span><span class="o">:</span><span class="n">Function</span><span class="o">):</span><span class="kc">void</span>
<span class="o">{</span>
  <span class="kd">var</span> <span class="n">result</span><span class="p">:</span><span class="kt">Function</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">value</span><span class="o">:</span><span class="n">Object</span><span class="o">):*</span>
  <span class="o">{</span>
    <span class="n">resultHandler</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">data</span><span class="o">,</span> <span class="n">value</span><span class="o">.</span><span class="na">hasMoreRecords</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="n">Promise</span><span class="o">.</span><span class="na">delay</span><span class="o">({</span><span class="n">data</span> <span class="o">:</span> <span class="o">[{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"X"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"Y"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"Z"</span><span class="o">}],</span> <span class="n">hasMoreRecords</span> <span class="o">:</span> <span class="kc">true</span><span class="o">},</span> <span class="mi">1000</span><span class="o">).</span><span class="n">then</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="n">otherwise</span><span class="o">(</span><span class="n">errorHandler</span><span class="o">);</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">refreshFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">resultHandler</span><span class="o">:</span><span class="n">Function</span><span class="o">,</span> <span class="n">errorHandler</span><span class="o">:</span><span class="n">Function</span><span class="o">):</span><span class="kc">void</span>
<span class="o">{</span>
  <span class="kd">var</span> <span class="n">result</span><span class="p">:</span><span class="kt">Function</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">value</span><span class="o">:</span><span class="n">Object</span><span class="o">):*</span>
  <span class="o">{</span>
    <span class="n">resultHandler</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">data</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="n">Promise</span><span class="o">.</span><span class="na">delay</span><span class="o">({</span><span class="n">data</span> <span class="o">:</span> <span class="o">[{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"A"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"B"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"C"</span><span class="o">}]},</span> <span class="mi">1000</span><span class="o">).</span><span class="n">then</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="n">otherwise</span><span class="o">(</span><span class="n">errorHandler</span><span class="o">);</span>
<span class="o">};</span>

</pre></div>

<p>In this example we uses [as3-promises] to simulate server response. Also take a look on <code>hasMoreRecords</code> param, this is flag that indicates if there are more earlier data to load, and note that it is used only for <code>load</code> and <code>proceed</code> function, but not for <code>refresh</code>.</p>

<h3>
<a name="customizing-appearance" class="anchor" href="#customizing-appearance"><span class="octicon octicon-link"></span></a>Customizing Appearance</h3>

<p>The next visual components could be specified: </p>

<ul>
<li>
<em>Header</em> that <strong>should</strong> implements <a href="src/feathersx/controls/pulltorefresh/Header.as">Header</a> interface,</li>
<li>
<em>Footer</em> that <strong>should</strong> implements <a href="src/feathersx/controls/pulltorefresh/Footer.as">Footer</a>  interface,</li>
<li>
<em>ErrorIndicator</em> (indicates error state) that <strong>could</strong> implements <a href="src/feathersx/controls/pulltorefresh/ErrorIndicator.as">ErrorIndicator</a> interface,</li>
<li>
<em>EmptyIndicator</em> (indicates empty state) that <strong>could</strong> implements <a href="src/feathersx/controls/pulltorefresh/EmptyIndicator.as">EmptyIndicator</a> interface and</li>
<li>
<em>LoadingIndicator</em> (indicates loading state) that have not special interface.</li>
</ul><p><strong>Note</strong>: The reason to implement correspond interfaces for error and empty indicators is they can receive error and empty strings. Each indicator is placed at the center of the PullToRefresh list.</p>

<p>Each of these components have default implementation, that could be overridden through factory method: </p>

<div class="highlight highlight-as3"><pre><span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">headerFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="o">():</span><span class="n">DisplayObject</span>
<span class="o">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="kt">CustomHeader</span><span class="o">();</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">footerFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="o">():</span><span class="n">DisplayObject</span>
<span class="o">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="kt">CustomFooter</span><span class="o">();</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">emptyIndicatorFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="o">():</span><span class="n">DisplayObject</span>
<span class="o">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="kt">DisplayObject</span><span class="o">();</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">errorIndicatorFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="o">():</span><span class="n">DisplayObject</span>
<span class="o">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="kt">DisplayObject</span><span class="o">();</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">loadingIndicatorFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="o">():</span><span class="n">DisplayObject</span>
<span class="o">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="kt">DisplayObject</span><span class="o">();</span>
<span class="o">};</span>
</pre></div>

<h3>
<a name="customizing-data-insert" class="anchor" href="#customizing-data-insert"><span class="octicon octicon-link"></span></a>Customizing Data Insert</h3>

<p>The default implementations of insert, append and prepend items could be overridden:</p>

<div class="highlight highlight-as3"><pre><span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">insertDataFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">items</span><span class="o">:</span><span class="n">Array</span><span class="o">):</span><span class="kc">void</span>
<span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">items</span><span class="o">;</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">appendDataFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">items</span><span class="o">:</span><span class="n">Array</span><span class="o">):</span><span class="kc">void</span>
<span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">addAllAt</span><span class="o">(</span><span class="k">new</span> <span class="kt">ListCollection</span><span class="o">(</span><span class="n">items</span><span class="o">),</span> <span class="mi">0</span><span class="o">);</span>
<span class="o">};</span>

<span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">prependDataFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">items</span><span class="o">:</span><span class="n">Array</span><span class="o">):</span><span class="kc">void</span>
<span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">pullToRefresh</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="k">new</span> <span class="kt">ListCollection</span><span class="o">(</span><span class="n">items</span><span class="o">));</span>
<span class="o">};</span>
</pre></div>

<h2>
<a name="using-provider" class="anchor" href="#using-provider"><span class="octicon octicon-link"></span></a>Using Provider</h2>

<p>The responsibility of work with server could be delegated to data provider. Just pass data provider that implements <a href="src/feathersx/controls/pulltorefresh/ErrorIndicator.as">Provider</a>:</p>

<div class="highlight highlight-as3"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="n">TodoProvider</span> <span class="kd">extends</span> <span class="n">ListCollection</span> <span class="kd">implements</span> <span class="n">Provider</span>
<span class="o">{</span>
  <span class="kd">public</span> <span class="kd">function </span><span class="nf">TodoProvider</span><span class="o">()</span>
  <span class="o">{</span>
   <span class="kd">super</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">function</span> <span class="kd">get</span> <span class="n">insertDataFunction</span><span class="o">():</span><span class="n">Function</span> <span class="o">{</span><span class="k">return</span> <span class="kc">null</span><span class="o">;}</span>

  <span class="kd">public</span> <span class="kd">function</span> <span class="kd">get</span> <span class="n">appendDataFunction</span><span class="o">():</span><span class="n">Function</span> <span class="o">{</span><span class="k">return</span> <span class="kc">null</span><span class="o">;}</span>

  <span class="kd">public</span> <span class="kd">function</span> <span class="kd">get</span> <span class="n">prependDataFunction</span><span class="o">():</span><span class="n">Function</span> <span class="o">{</span><span class="k">return</span> <span class="kc">null</span><span class="o">;}</span>

  <span class="kd">public</span> <span class="kd">function </span><span class="nf">load</span><span class="o">(</span><span class="n">result</span><span class="o">:</span><span class="kt">Function</span><span class="o">,</span> <span class="n">error</span><span class="o">:</span><span class="kt">Function</span><span class="o">):</span><span class="kt">void</span>
  <span class="o">{</span>
    <span class="kd">var</span> <span class="n">result</span><span class="p">:</span><span class="kt">Function</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">value</span><span class="o">:</span><span class="n">Object</span><span class="o">):*</span>
    <span class="o">{</span>
      <span class="n">resultHandler</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">data</span><span class="o">,</span> <span class="n">value</span><span class="o">.</span><span class="na">hasMoreRecords</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">Promise</span><span class="o">.</span><span class="na">delay</span><span class="o">({</span><span class="n">data</span> <span class="o">:</span> <span class="o">[{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"M"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"N"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"O"</span><span class="o">}],</span> <span class="n">hasMoreRecords</span> <span class="o">:</span> <span class="kc">true</span><span class="o">},</span> <span class="mi">1000</span><span class="o">).</span><span class="n">then</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="n">otherwise</span><span class="o">(</span><span class="n">errorHandler</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">function </span><span class="nf">refresh</span><span class="o">(</span><span class="n">result</span><span class="o">:</span><span class="kt">Function</span><span class="o">,</span> <span class="n">error</span><span class="o">:</span><span class="kt">Function</span><span class="o">):</span><span class="kt">void</span>
  <span class="o">{</span>
    <span class="kd">var</span> <span class="n">result</span><span class="p">:</span><span class="kt">Function</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">value</span><span class="o">:</span><span class="n">Object</span><span class="o">):*</span>
    <span class="o">{</span>
      <span class="n">resultHandler</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">data</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">Promise</span><span class="o">.</span><span class="na">delay</span><span class="o">({</span><span class="n">data</span> <span class="o">:</span> <span class="o">[{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"A"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"B"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"C"</span><span class="o">}]},</span> <span class="mi">1000</span><span class="o">).</span><span class="n">then</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="n">otherwise</span><span class="o">(</span><span class="n">errorHandler</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">function </span><span class="nf">proceed</span><span class="o">(</span><span class="n">result</span><span class="o">:</span><span class="kt">Function</span><span class="o">,</span> <span class="n">error</span><span class="o">:</span><span class="kt">Function</span><span class="o">):</span><span class="kt">void</span>
  <span class="o">{</span>
    <span class="kd">var</span> <span class="n">result</span><span class="p">:</span><span class="kt">Function</span> <span class="o">=</span> <span class="kd">function</span><span class="o">(</span><span class="n">value</span><span class="o">:</span><span class="n">Object</span><span class="o">):*</span>
    <span class="o">{</span>
      <span class="n">resultHandler</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">data</span><span class="o">,</span> <span class="n">value</span><span class="o">.</span><span class="na">hasMoreRecords</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">Promise</span><span class="o">.</span><span class="na">delay</span><span class="o">({</span><span class="n">data</span> <span class="o">:</span> <span class="o">[{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"X"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"Y"</span><span class="o">},</span> <span class="o">{</span><span class="n">label</span> <span class="o">:</span> <span class="s2">"Z"</span><span class="o">}],</span> <span class="n">hasMoreRecords</span> <span class="o">:</span> <span class="kc">true</span><span class="o">},</span> <span class="mi">1000</span><span class="o">).</span><span class="n">then</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="n">otherwise</span><span class="o">(</span><span class="n">errorHandler</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/rozd/pull-to-refresh/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/rozd/pull-to-refresh/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/rozd/pull-to-refresh"></a> is maintained by <a href="https://github.com/rozd">rozd</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
